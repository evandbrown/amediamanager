option_settings:
  - option_name: APP_CONFIG_FILE
    value: "/var/amm-web/config"

files:
  "/var/amm-web/config":
    mode: "000444"
    owner: "tomcat"
    group: "root"
    content: |
      DDB_USERS_TABLE=`{ "Ref" : "UsersTable"}`
      AWS_REGION=`{ "Ref" : "AWS::Region"}`
      S3_UPLOAD_BUCKET=`{ "Ref" : "S3Bucket"}`
      RDS_DATABASE=`{"Ref": "AWSEBDBName"}`
      RDS_USERNAME=`{"Ref": "AWSEBDBUser"}`
      RDS_PASSWORD=`{"Ref": "AWSEBDBPassword"}`
      RDS_INSTANCEID=`{"Ref": "AWSEBRDSDatabase"}`
      S3_UPLOAD_PREFIX=uploads
      S3_PROFILE_PIC_PREFIX=profile
      CF_STATIC_URL=static/
      CF_STREAMING_URL=
      DEFAULT_PROFILE_PIC_KEY=img/default_profile_pic.png
      SNS_NEW_CONTENT_TOPIC=
      
Resources:
  S3Bucket:
    Type: AWS::S3::Bucket
  UsersTable:
    Type: AWS::DynamoDB::Table
    Properties:
      KeySchema: 
        HashKeyElement:
          AttributeName: "EMail"
          AttributeType: "S"
      ProvisionedThroughput:
        ReadCapacityUnits: 1
        WriteCapacityUnits: 1